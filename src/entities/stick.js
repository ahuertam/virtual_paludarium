import {rand,lerp} from '../utils.js';
export function createStick(W,groundYAt){const x=lerp(80,W-80,rand());const y=groundYAt(x)-18;const dir=rand()<0.5?-1:1;return{x,y,vx:dir*1.2,dir,len:32,baseLen:32,leg:12,eaten:0};}
export function updateStick(i,groundYAt,W){const gy=groundYAt(i.x);i.y=gy-18;i.x+=i.vx;if(i.x<20){i.x=20;i.vx=Math.abs(i.vx);}if(i.x>W-20){i.x=W-20;i.vx=-Math.abs(i.vx);}if(rand()<0.01)i.vx*=-1;}
export function drawStick(ctx,i){ctx.strokeStyle="#3d3d3d";ctx.lineWidth=3;ctx.beginPath();ctx.moveTo(i.x-i.len/2,i.y);ctx.lineTo(i.x+i.len/2,i.y);ctx.stroke();ctx.lineWidth=2;ctx.beginPath();ctx.moveTo(i.x-i.len*0.25,i.y);ctx.lineTo(i.x-i.len*0.25,i.y+i.leg);ctx.moveTo(i.x+i.len*0.25,i.y);ctx.lineTo(i.x+i.len*0.25,i.y+i.leg);ctx.stroke();}
export function eat(sticks,foods){for(let i=0;i<sticks.length;i++){const bug=sticks[i];for(let j=foods.length-1;j>=0;j--){const f=foods[j];if(!f.rest)continue;const fx=f.x,fy=f.y+f.size/2;const dist=Math.hypot(bug.x-fx,bug.y-fy);if(dist<(bug.len*0.3+f.size*0.6)){foods.splice(j,1);bug.eaten=(bug.eaten||0)+1;bug.baseLen=bug.baseLen||bug.len;if(bug.eaten%5===0){bug.len=Math.min(bug.baseLen*4,bug.len*1.2);bug.leg=Math.min(bug.leg*1.15,bug.baseLen*2);}}}}}
